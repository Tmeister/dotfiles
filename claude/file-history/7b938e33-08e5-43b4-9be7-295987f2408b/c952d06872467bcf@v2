# Dotfiles

Personal dotfiles configuration for Arch Linux with Hyprland and Omarchy.

## Quick Start

### Fresh Installation

```bash
# 1. Clone dotfiles
git clone <your-repo-url> ~/.dotfiles
cd ~/.dotfiles

# 2. Install GNU Stow (if not already installed)
sudo pacman -S stow

# 3. Run installation script
./install.sh
```

The installer will:
- Check for conflicts and create backups
- Deploy all configs using stow
- Set up custom scripts and omarchy hooks
- Configure PATH precedence

### Updating Dotfiles

```bash
cd ~/.dotfiles
git pull
./restow.sh
```

To restow specific packages:
```bash
./restow.sh zsh hypr  # Only restow zsh and hypr
```

## Package Structure

This repository uses **GNU Stow** for symlink management. Each directory is a stow package:

| Package | Description | Target Location |
|---------|-------------|-----------------|
| `zsh/` | Shell config with zinit | `~/.zshrc` |
| `hypr/` | Hyprland WM (omarchy override) | `~/.config/hypr/` |
| `walker/` | Walker launcher (omarchy override) | `~/.config/walker/` |
| `waybar/` | Status bar (omarchy override) | `~/.config/waybar/` |
| `nvim/` | Neovim config (omarchy override) | `~/.config/nvim/` |
| `alacritty/` | Alacritty terminal | `~/.config/alacritty/` |
| `ghostty/` | Ghostty terminal | `~/.config/ghostty/` |
| `tmux/` | Tmux multiplexer | `~/.tmux.conf` |
| `starship/` | Starship prompt | `~/.config/starship.toml` |
| `ohmyposh/` | Oh My Posh prompt | `~/.config/ohmyposh/` |
| `claude/` | Claude Code config | `~/.claude/` |
| `scripts/` | Custom scripts + omarchy hooks | `~/.local/bin/`, `~/.config/omarchy/hooks/` |

### Adding New Files

After adding new files to a package:

```bash
./restow.sh <package-name>
```

Or restow everything:
```bash
./restow.sh
```

## Omarchy Integration

This dotfiles setup **overrides** Omarchy's default configs while still leveraging its features.

### How It Works

**Omarchy's 3-Layer System:**
1. **Default Layer** (`~/.local/share/omarchy/default/`) - Read-only templates (we source these)
2. **Config Layer** (`~/.local/share/omarchy/config/`) - Updatable configs (we bypass this)
3. **User Layer** (`~/.config/`) - Our dotfiles symlink here (full override)

**Our Strategy:**
- Symlink entire directories (`~/.config/hypr` â†’ `~/.dotfiles/hypr/.config/hypr`)
- Still source omarchy's defaults where useful (media keys, tiling, themes)
- Custom scripts take precedence via PATH priority

### Key Customizations

See [`OMARCHY.md`](./OMARCHY.md) for complete documentation.

**Hyprland:**
- Vicinae launcher (SUPER+SPACE)
- 75% keyboard support (HOME for screenshots)
- Custom app bindings (Gmail, Claude, Inkdrop, DeepL)
- Dual monitor workspace management

**Waybar:**
- Persistent workspaces per monitor (DP-1: 1-5, HDMI-A-1: 6-10)
- Faster update checks (1h vs 6h)

**Walker:**
- Raycast-inspired theme
- Clipboard manager (SUPER+V)
- Emoji picker (SUPER+.)

### After Omarchy Updates

When you run `omarchy-update`:

1. **Automatic Hook** (`~/.config/omarchy/hooks/post-update`):
   - Verifies all symlinks intact
   - Shows what changed in omarchy
   - Checks PATH precedence

2. **Manual Review** (optional):
   ```bash
   omarchy-diff              # Show recent changes
   omarchy-diff hypr         # Compare hypr configs
   omarchy-customizations    # List all your overrides
   ```

3. **Merge Useful Changes** (if desired):
   - Review omarchy's new features
   - Manually add to your dotfiles
   - Commit with note

## Helper Commands

### Omarchy Tools

```bash
omarchy-customizations    # List all active overrides
omarchy-diff              # Show recent omarchy changes
omarchy-diff hypr         # Compare hypr configs with omarchy
omarchy-diff log 20       # Show last 20 omarchy commits
```

### Stow Management

```bash
./install.sh              # Full installation with backups
./restow.sh               # Restow all packages
./restow.sh zsh hypr      # Restow specific packages
stow --adopt <package>    # Adopt conflicting files into dotfiles
stow --delete <package>   # Remove package symlinks
```

## Walker Launcher Customizations

### Raycast-Inspired Theme

Custom Walker theme that mimics Raycast's clean, modern design with dynamic Omarchy colors.

#### Files

**Theme Files:**
- `walker/.config/walker/custom-theme.css` - Main Walker launcher theme (Super + Space)
- `walker/.config/walker/omarchy-menu.css` - Omarchy menu theme
- `walker/.config/walker/omarchy-menu.toml` - Menu sizing and configuration
- `walker/.config/walker/config.toml` - Walker configuration with theme settings

**Custom Script:**
- `scripts/.local/bin/omarchy-menu` - Overrides omarchy's version with custom theme

#### Features

- **Raycast-style design** with rounded corners (4px radius)
- **Dynamic colors** from Omarchy theme (`@base`, `@text`, `@selected-text`, `@border`)
- **Dark semi-transparent background** with backdrop blur
- **Clean typography** using Liberation Sans font
- **Subtle hover effects** (5-6% opacity)
- **Minimal scrollbar** design
- **No animations** for instant response

#### How Custom omarchy-menu Works

Our custom `omarchy-menu` script lives at `~/.local/bin/omarchy-menu` and takes precedence over omarchy's version because:

1. `~/.local/bin` is **first in PATH** (see `zsh/.zshrc:121`)
2. Omarchy's version is at `/home/tmeister/.local/share/omarchy/bin/omarchy-menu`
3. When you press the keybinding, our version runs

**After omarchy updates**, the hook automatically verifies this precedence.

## Hyprland Bindings

### Custom Application Bindings

- `Super + I` - Inkdrop notes
- `Super + L` - DeepL translator
- `Super + .` - Emoji picker (walker)
- `Super + V` - Clipboard manager (walker with auto-paste)
- `Super + S` - Resolution toggle (cycles through 1.25x, 1.5x, 2.0x scaling)

### Web App Bindings

All web apps use Chromium with `--app` flag for clean windows:

- `Super + A` - ChatGPT
- `Super + C` - Claude
- `Super + M` - Gmail
- `Super + Y` - YouTube
- `Super + X` - X/Twitter
- `Super + Shift + X` - X Post composer
- `Super + Shift + G` - WhatsApp
- `Super + Alt + G` - Google Messages

### 75% Keyboard Support

Modified bindings for keyboards without dedicated keys:

- **Screenshot** - `HOME` key (instead of PRINT)

## Waybar Customizations

**Dual Monitor Setup:**
- DP-1 (Primary): Workspaces 1-5
- HDMI-A-1 (Secondary): Workspaces 6-10

**Update Checks:**
- Frequency: Every 1 hour (vs 6h default)

**Styling:**
- Darker background (65% opacity)
- Custom Omarchy menu icon
- Update indicator

## Font Configuration

- **System font:** Liberation Sans
- **Monospace:** JetBrains Mono NL
- **Config:** `~/.config/fontconfig/fonts.conf`

## Workflow Tools

### ThePrimeagen's Tmux Sessionizer

**Script:** `scripts/.local/bin/tmux-sessionizer`
**Alias:** `pw` (project workflow)

Quick project switcher using tmux and fzf.

### GitHub Weekly Summary

**Script:** `scripts/.local/bin/github-weekly-summary`

Generate weekly GitHub activity reports.

## Documentation

- [`OMARCHY.md`](./OMARCHY.md) - Complete omarchy override documentation
- [`MIGRATION.md`](./MIGRATION.md) - Stow migration notes
- [`install.sh`](./install.sh) - Installation script with comments
- [`restow.sh`](./restow.sh) - Restow helper script

## Backup Strategy

### Before Making Changes

The `install.sh` script automatically creates timestamped backups:

```
~/.dotfiles-backup-YYYYMMDD-HHMMSS/
```

### Manual Backups

```bash
# Backup current config before experimenting
cp -r ~/.config/hypr ~/.config/hypr.backup
```

### Omarchy Original Configs

Omarchy configs are preserved in:
- `~/.config/hypr.om` - Original omarchy hypr config
- `~/.config/waybar.om` - Original omarchy waybar config
- `~/.config/nvim.om` - Original omarchy nvim config

## Troubleshooting

### Symlink Conflicts

If stow reports conflicts:

```bash
# Option 1: Let stow adopt the files into dotfiles
cd ~/.dotfiles
stow --adopt <package>
git diff  # Review what changed

# Option 2: Backup and remove conflicts
mv ~/.config/hypr ~/.config/hypr.backup
./restow.sh hypr
```

### Broken Omarchy Integration

If omarchy stops working after updates:

```bash
# Check symlinks
ls -la ~/.config | grep '\->'

# Verify hook ran
cat ~/.config/omarchy/hooks/post-update

# Review what changed
omarchy-diff
```

### PATH Issues

If custom scripts don't take precedence:

```bash
# Check PATH order
echo $PATH | tr ':' '\n' | grep -n local

# Verify which version is running
which omarchy-menu  # Should show ~/.local/bin/omarchy-menu

# Reload shell
exec zsh
```

## Cross-Platform Notes

This setup is optimized for **Arch Linux** but designed with cross-platform compatibility in mind:

- Shell configs detect platform-specific features
- Conditional loading for Linux-only tools
- macOS-specific configs removed (old oh-my-zsh setup)

For macOS or other distros, you may need to:
- Adjust package installation commands
- Modify PATH configurations
- Skip omarchy-specific packages

## Contributing to Your Dotfiles

### Workflow

1. Make changes to files in `~/.dotfiles/<package>/`
2. Test changes (they're live via symlinks)
3. Commit when satisfied
4. Push to backup/sync

### Adding New Packages

```bash
cd ~/.dotfiles

# Create package structure
mkdir -p new-package/.config/new-app
cp -r ~/.config/new-app/* new-package/.config/new-app/

# Remove original
rm -rf ~/.config/new-app

# Stow it
stow new-package

# Add to install.sh PACKAGES array
```

## License

Personal dotfiles - use at your own risk. Feel free to fork and adapt.

## Credits

- **Omarchy** - Base Arch Linux + Hyprland environment
- **ThePrimeagen** - tmux-sessionizer script
- **GNU Stow** - Symlink management
- **zinit** - ZSH plugin manager
